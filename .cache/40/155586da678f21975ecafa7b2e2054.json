{"id":"kMJa","dependencies":[{"name":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/package.json","includedInParent":true,"mtime":1627058517687},{"name":"../models/userModel","loc":{"line":1,"column":21},"parent":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/controllers/authController.js","resolved":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/models/userModel.js"},{"name":"jsonwebtoken","loc":{"line":2,"column":20},"parent":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/controllers/authController.js","resolved":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/node_modules/jsonwebtoken/index.js"},{"name":"util","loc":{"line":3,"column":30},"parent":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/controllers/authController.js","resolved":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/node_modules/util/util.js"},{"name":"crypto","loc":{"line":4,"column":23},"parent":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/controllers/authController.js","resolved":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/node_modules/crypto-browserify/index.js"},{"name":"../utils/appError","loc":{"line":6,"column":25},"parent":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/controllers/authController.js","resolved":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/utils/appError.js"},{"name":"../utils/catchAsync","loc":{"line":7,"column":27},"parent":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/controllers/authController.js","resolved":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/utils/catchAsync.js"},{"name":"../utils/email","loc":{"line":8,"column":22},"parent":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/controllers/authController.js","resolved":"/Users/ellenwang/Desktop/Ellen practice/Projects/Node projects/Projects/kimchi daddy/utils/email.js"}],"generated":{"js":"function e(e,r,t,n,s,a,o){try{var u=e[a](o),i=u.value}catch(c){return void t(c)}u.done?r(i):Promise.resolve(i).then(n,s)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(s,a){var o=r.apply(t,n);function u(r){e(o,s,a,u,i,\"next\",r)}function i(r){e(o,s,a,u,i,\"throw\",r)}u(void 0)})}}var t=require(\"../models/userModel\"),n=require(\"jsonwebtoken\"),s=require(\"util\"),a=s.promisify,o=require(\"crypto\"),u=require(\"../utils/appError\"),i=require(\"../utils/catchAsync\"),c=require(\"../utils/email\"),p=function(e){return n.sign({id:e},void 0,{expiresIn:void 0})},d=function(e,r,t,n){var s=p(e._id);n.cookie(\"jwt\",s,{expires:new Date(Date.now()+NaN),secure:t.secure||\"https\"===t.headers[\"x-forwarded-proto\"],httpOnly:!0}),e.password=void 0,n.status(r).json({status:\"success\",token:s,data:{user:e}})};exports.signup=i(function(){var e=r(regeneratorRuntime.mark(function e(r,n,s){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.create(r.body);case 2:return a=e.sent,o=\"\".concat(r.protocol,\"://\").concat(r.get(\"host\"),\"/me\"),e.next=6,new c(a,o).sendWelcome();case 6:d(a,201,r,n);case 7:case\"end\":return e.stop()}},e)}));return function(r,t,n){return e.apply(this,arguments)}}()),exports.login=i(function(){var e=r(regeneratorRuntime.mark(function e(r,n,s){var a,o,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.body,o=a.email,i=a.password,o&&i){e.next=3;break}return e.abrupt(\"return\",s(new u(\"Please eneter your email and password\",400)));case 3:return e.next=5,t.findOne({email:o}).select(\"+password\");case 5:if(c=e.sent,e.t0=!c,e.t0){e.next=11;break}return e.next=10,c.correctPassword(i,c.password);case 10:e.t0=!e.sent;case 11:if(!e.t0){e.next=13;break}return e.abrupt(\"return\",s(new u(\"Invalid email or password\",401)));case 13:d(c,200,r,n);case 14:case\"end\":return e.stop()}},e)}));return function(r,t,n){return e.apply(this,arguments)}}()),exports.logout=function(e,r){r.cookie(\"jwt\",\"loggedout\",{expires:new Date(Date.now()+1e4),httpOnly:!0}),r.status(200).json({status:\"success\"})},exports.protect=i(function(){var e=r(regeneratorRuntime.mark(function e(r,s,o){var i,c,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.headers.authorization&&r.headers.authorization.startsWith(\"Bearer\")?i=r.headers.authorization.replace(\"Bearer \",\"\"):r.cookies.jwt&&(i=r.cookies.jwt),i){e.next=3;break}return e.abrupt(\"return\",o(new u(\"You are not logged in. Please log on to get access\",401)));case 3:return e.next=5,a(n.verify)(i,void 0);case 5:return c=e.sent,e.next=8,t.findById(c.id);case 8:if((p=e.sent)||o(new u(\"The user belonging to this token does no longer exist\",401)),!p.changedPasswordAfter(c.iat)){e.next=12;break}return e.abrupt(\"return\",o(new u(\"user recently changed password! Please log in again\",401)));case 12:r.user=p,s.locals.user=p,o();case 15:case\"end\":return e.stop()}},e)}));return function(r,t,n){return e.apply(this,arguments)}}()),exports.isLoggedIn=function(){var e=r(regeneratorRuntime.mark(function e(r,s,o){var u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.cookies.jwt){e.next=17;break}return e.prev=1,e.next=4,a(n.verify)(r.cookies.jwt,void 0);case 4:return u=e.sent,e.next=7,t.findById(u.id);case 7:if(!(i=e.sent).changedPasswordAfter(u.iat)){e.next=10;break}return e.abrupt(\"return\",o());case 10:return s.locals.user=i,e.abrupt(\"return\",o());case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt(\"return\",o());case 17:o();case 18:case\"end\":return e.stop()}},e,null,[[1,14]])}));return function(r,t,n){return e.apply(this,arguments)}}(),exports.restrictTo=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(e,t,n){var s=e.user;if(!r.includes(s.role))return n(new u(\"You do not have permission to perform this action\",403));n()}},exports.forgotPassword=i(function(){var e=r(regeneratorRuntime.mark(function e(r,n,s){var a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.findOne({email:r.body.email});case 2:if(a=e.sent){e.next=5;break}return e.abrupt(\"return\",s(new u(\"User not found\",404)));case 5:return o=a.createPasswordResetToken(),e.next=8,a.save({validateBeforeSave:!1});case 8:return e.prev=8,i=\"\".concat(r.protocol,\"://\").concat(r.get(\"host\"),\"/api/v1/users/resetPassword/\").concat(o),e.next=12,new c(a,i).sendPasswordReset();case 12:n.status(200).json({status:\"success\",message:\"token sent to email\"}),e.next=22;break;case 15:return e.prev=15,e.t0=e.catch(8),a.passwordResetToken=void 0,a.passwordResetExpires=void 0,e.next=21,a.save({validateBeforeSave:!1});case 21:return e.abrupt(\"return\",s(new u(\"There was an error sending the email. Try again later.\",500)));case 22:case\"end\":return e.stop()}},e,null,[[8,15]])}));return function(r,t,n){return e.apply(this,arguments)}}()),exports.resetPassword=i(function(){var e=r(regeneratorRuntime.mark(function e(r,n,s){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.createHash(\"sha256\").update(r.params.token).digest(\"hex\"),e.next=3,t.findOne({passwordResetToken:a,passwordResetExpires:{$gt:Date.now()}});case 3:if(i=e.sent){e.next=6;break}return e.abrupt(\"return\",s(new u(\"Token is invalid or has expired\",400)));case 6:return i.password=r.body.password,i.passwordConfirm=r.body.passwordConfirm,i.passwordResetExpires=void 0,i.passwordResetToken=void 0,e.next=12,i.save();case 12:d(i,200,r,n);case 13:case\"end\":return e.stop()}},e)}));return function(r,t,n){return e.apply(this,arguments)}}()),exports.updatePassword=i(function(){var e=r(regeneratorRuntime.mark(function e(r,n,s){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.findById(r.user.id).select(\"+password\");case 2:return a=e.sent,e.next=5,a.correctPassword(r.body.passwordCurrent,a.password);case 5:if(e.sent){e.next=7;break}return e.abrupt(\"return\",s(new u(\"Invalid password\",401)));case 7:return a.password=r.body.password,a.passwordConfirm=r.body.passwordConfirm,e.next=11,a.save();case 11:d(a,200,r,n);case 12:case\"end\":return e.stop()}},e)}));return function(r,t,n){return e.apply(this,arguments)}}());"},"sourceMaps":{"js":{"mappings":[{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":0}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":9}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":11}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":13}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":15}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":17}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":19}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":21}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":23}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":26}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":30}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":34}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":36}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":38}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":41}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":44}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":46}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":48}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":54}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":60}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":63}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":75}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":77}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":80}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":82}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":87}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":89}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":92}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":100}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":108}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":111}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":116}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":118}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":121}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":130}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":132}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":135}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":142}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":153}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":157}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":159}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":164}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":166}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":176}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":183}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":187}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":195}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":204}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":206}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":209}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":213}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":215}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":217}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":223}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":225}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":228}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":237}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":239}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":242}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":244}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":246}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":248}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":250}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":252}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":254}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":261}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":264}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":273}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":275}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":278}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":280}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":282}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":284}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":286}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":288}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":290}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":298}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":301}},{"source":"../../controllers/authController.js","original":{"line":216,"column":0},"generated":{"line":1,"column":308}},{"source":"../../controllers/authController.js","original":{"line":1,"column":0},"generated":{"line":1,"column":314}},{"source":"../../controllers/authController.js","name":"User","original":{"line":1,"column":6},"generated":{"line":1,"column":318}},{"source":"../../controllers/authController.js","name":"require","original":{"line":1,"column":13},"generated":{"line":1,"column":320}},{"source":"../../controllers/authController.js","original":{"line":1,"column":21},"generated":{"line":1,"column":328}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":2,"column":6},"generated":{"line":1,"column":351}},{"source":"../../controllers/authController.js","name":"require","original":{"line":2,"column":12},"generated":{"line":1,"column":353}},{"source":"../../controllers/authController.js","original":{"line":2,"column":20},"generated":{"line":1,"column":361}},{"source":"../../controllers/authController.js","name":"require","original":{"line":3,"column":22},"generated":{"line":1,"column":377}},{"source":"../../controllers/authController.js","name":"require","original":{"line":3,"column":22},"generated":{"line":1,"column":379}},{"source":"../../controllers/authController.js","original":{"line":3,"column":30},"generated":{"line":1,"column":387}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":3,"column":8},"generated":{"line":1,"column":395}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":3,"column":8},"generated":{"line":1,"column":397}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":3,"column":8},"generated":{"line":1,"column":399}},{"source":"../../controllers/authController.js","name":"crypto","original":{"line":4,"column":6},"generated":{"line":1,"column":409}},{"source":"../../controllers/authController.js","name":"require","original":{"line":4,"column":15},"generated":{"line":1,"column":411}},{"source":"../../controllers/authController.js","original":{"line":4,"column":23},"generated":{"line":1,"column":419}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":6,"column":6},"generated":{"line":1,"column":429}},{"source":"../../controllers/authController.js","name":"require","original":{"line":6,"column":17},"generated":{"line":1,"column":431}},{"source":"../../controllers/authController.js","original":{"line":6,"column":25},"generated":{"line":1,"column":439}},{"source":"../../controllers/authController.js","name":"catchAsync","original":{"line":7,"column":6},"generated":{"line":1,"column":460}},{"source":"../../controllers/authController.js","name":"require","original":{"line":7,"column":19},"generated":{"line":1,"column":462}},{"source":"../../controllers/authController.js","original":{"line":7,"column":27},"generated":{"line":1,"column":470}},{"source":"../../controllers/authController.js","name":"Email","original":{"line":8,"column":6},"generated":{"line":1,"column":493}},{"source":"../../controllers/authController.js","name":"require","original":{"line":8,"column":14},"generated":{"line":1,"column":495}},{"source":"../../controllers/authController.js","original":{"line":8,"column":22},"generated":{"line":1,"column":503}},{"source":"../../controllers/authController.js","name":"signToken","original":{"line":12,"column":6},"generated":{"line":1,"column":521}},{"source":"../../controllers/authController.js","original":{"line":12,"column":18},"generated":{"line":1,"column":523}},{"source":"../../controllers/authController.js","name":"id","original":{"line":12,"column":19},"generated":{"line":1,"column":532}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":13,"column":9},"generated":{"line":1,"column":535}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":13,"column":9},"generated":{"line":1,"column":542}},{"source":"../../controllers/authController.js","name":"sign","original":{"line":13,"column":13},"generated":{"line":1,"column":544}},{"source":"../../controllers/authController.js","original":{"line":13,"column":18},"generated":{"line":1,"column":549}},{"source":"../../controllers/authController.js","name":"id","original":{"line":13,"column":20},"generated":{"line":1,"column":550}},{"source":"../../controllers/authController.js","name":"id","original":{"line":13,"column":20},"generated":{"line":1,"column":553}},{"source":"../../controllers/authController.js","original":{"line":13,"column":50},"generated":{"line":1,"column":561}},{"source":"../../controllers/authController.js","original":{"line":13,"column":50},"generated":{"line":1,"column":563}},{"source":"../../controllers/authController.js","name":"expiresIn","original":{"line":14,"column":4},"generated":{"line":1,"column":564}},{"source":"../../controllers/authController.js","original":{"line":14,"column":13},"generated":{"line":1,"column":579}},{"source":"../../controllers/authController.js","name":"createSendToken","original":{"line":18,"column":6},"generated":{"line":1,"column":584}},{"source":"../../controllers/authController.js","original":{"line":18,"column":24},"generated":{"line":1,"column":586}},{"source":"../../controllers/authController.js","name":"user","original":{"line":18,"column":25},"generated":{"line":1,"column":595}},{"source":"../../controllers/authController.js","name":"statusCode","original":{"line":18,"column":31},"generated":{"line":1,"column":597}},{"source":"../../controllers/authController.js","name":"req","original":{"line":18,"column":43},"generated":{"line":1,"column":599}},{"source":"../../controllers/authController.js","name":"res","original":{"line":18,"column":48},"generated":{"line":1,"column":601}},{"source":"../../controllers/authController.js","name":"token","original":{"line":19,"column":8},"generated":{"line":1,"column":604}},{"source":"../../controllers/authController.js","name":"token","original":{"line":19,"column":8},"generated":{"line":1,"column":608}},{"source":"../../controllers/authController.js","name":"signToken","original":{"line":19,"column":16},"generated":{"line":1,"column":610}},{"source":"../../controllers/authController.js","name":"user","original":{"line":19,"column":26},"generated":{"line":1,"column":612}},{"source":"../../controllers/authController.js","name":"_id","original":{"line":19,"column":31},"generated":{"line":1,"column":614}},{"source":"../../controllers/authController.js","name":"res","original":{"line":21,"column":2},"generated":{"line":1,"column":619}},{"source":"../../controllers/authController.js","name":"cookie","original":{"line":21,"column":6},"generated":{"line":1,"column":621}},{"source":"../../controllers/authController.js","original":{"line":21,"column":13},"generated":{"line":1,"column":628}},{"source":"../../controllers/authController.js","name":"token","original":{"line":21,"column":20},"generated":{"line":1,"column":634}},{"source":"../../controllers/authController.js","original":{"line":21,"column":27},"generated":{"line":1,"column":636}},{"source":"../../controllers/authController.js","name":"expires","original":{"line":22,"column":4},"generated":{"line":1,"column":637}},{"source":"../../controllers/authController.js","original":{"line":22,"column":13},"generated":{"line":1,"column":645}},{"source":"../../controllers/authController.js","name":"Date","original":{"line":22,"column":17},"generated":{"line":1,"column":649}},{"source":"../../controllers/authController.js","name":"Date","original":{"line":23,"column":6},"generated":{"line":1,"column":654}},{"source":"../../controllers/authController.js","name":"now","original":{"line":23,"column":11},"generated":{"line":1,"column":659}},{"source":"../../controllers/authController.js","original":{"line":23,"column":19},"generated":{"line":1,"column":665}},{"source":"../../controllers/authController.js","name":"secure","original":{"line":26,"column":4},"generated":{"line":1,"column":670}},{"source":"../../controllers/authController.js","name":"req","original":{"line":26,"column":12},"generated":{"line":1,"column":677}},{"source":"../../controllers/authController.js","name":"secure","original":{"line":26,"column":16},"generated":{"line":1,"column":679}},{"source":"../../controllers/authController.js","original":{"line":26,"column":63},"generated":{"line":1,"column":687}},{"source":"../../controllers/authController.js","name":"req","original":{"line":26,"column":26},"generated":{"line":1,"column":697}},{"source":"../../controllers/authController.js","name":"headers","original":{"line":26,"column":30},"generated":{"line":1,"column":699}},{"source":"../../controllers/authController.js","original":{"line":26,"column":38},"generated":{"line":1,"column":707}},{"source":"../../controllers/authController.js","name":"httpOnly","original":{"line":28,"column":4},"generated":{"line":1,"column":728}},{"source":"../../controllers/authController.js","original":{"line":28,"column":14},"generated":{"line":1,"column":738}},{"source":"../../controllers/authController.js","name":"user","original":{"line":31,"column":2},"generated":{"line":1,"column":742}},{"source":"../../controllers/authController.js","name":"password","original":{"line":31,"column":7},"generated":{"line":1,"column":744}},{"source":"../../controllers/authController.js","name":"undefined","original":{"line":31,"column":18},"generated":{"line":1,"column":758}},{"source":"../../controllers/authController.js","name":"res","original":{"line":33,"column":2},"generated":{"line":1,"column":760}},{"source":"../../controllers/authController.js","name":"status","original":{"line":33,"column":6},"generated":{"line":1,"column":762}},{"source":"../../controllers/authController.js","name":"statusCode","original":{"line":33,"column":13},"generated":{"line":1,"column":769}},{"source":"../../controllers/authController.js","name":"json","original":{"line":33,"column":25},"generated":{"line":1,"column":772}},{"source":"../../controllers/authController.js","original":{"line":33,"column":30},"generated":{"line":1,"column":777}},{"source":"../../controllers/authController.js","name":"status","original":{"line":34,"column":4},"generated":{"line":1,"column":778}},{"source":"../../controllers/authController.js","original":{"line":34,"column":12},"generated":{"line":1,"column":785}},{"source":"../../controllers/authController.js","name":"token","original":{"line":35,"column":4},"generated":{"line":1,"column":795}},{"source":"../../controllers/authController.js","name":"token","original":{"line":35,"column":4},"generated":{"line":1,"column":801}},{"source":"../../controllers/authController.js","name":"data","original":{"line":36,"column":4},"generated":{"line":1,"column":803}},{"source":"../../controllers/authController.js","original":{"line":36,"column":10},"generated":{"line":1,"column":808}},{"source":"../../controllers/authController.js","name":"user","original":{"line":37,"column":6},"generated":{"line":1,"column":809}},{"source":"../../controllers/authController.js","name":"user","original":{"line":37,"column":6},"generated":{"line":1,"column":814}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":42,"column":0},"generated":{"line":1,"column":820}},{"source":"../../controllers/authController.js","name":"signup","original":{"line":42,"column":8},"generated":{"line":1,"column":828}},{"source":"../../controllers/authController.js","name":"catchAsync","original":{"line":42,"column":17},"generated":{"line":1,"column":835}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":837}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":848}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":852}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":854}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":856}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":875}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":880}},{"source":"../../controllers/authController.js","name":"req","original":{"line":42,"column":35},"generated":{"line":1,"column":889}},{"source":"../../controllers/authController.js","name":"req","original":{"line":42,"column":35},"generated":{"line":1,"column":891}},{"source":"../../controllers/authController.js","name":"res","original":{"line":42,"column":40},"generated":{"line":1,"column":893}},{"source":"../../controllers/authController.js","name":"next","original":{"line":42,"column":45},"generated":{"line":1,"column":895}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":898}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":902}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":904}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":906}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":913}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":932}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":937}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":946}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":949}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":956}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":963}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":965}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":970}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":972}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":978}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":983}},{"source":"../../controllers/authController.js","name":"User","original":{"line":43,"column":24},"generated":{"line":1,"column":985}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":992}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":994}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":999}},{"source":"../../controllers/authController.js","name":"User","original":{"line":43,"column":24},"generated":{"line":1,"column":1001}},{"source":"../../controllers/authController.js","name":"create","original":{"line":43,"column":29},"generated":{"line":1,"column":1003}},{"source":"../../controllers/authController.js","name":"req","original":{"line":43,"column":36},"generated":{"line":1,"column":1010}},{"source":"../../controllers/authController.js","name":"body","original":{"line":43,"column":40},"generated":{"line":1,"column":1012}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1018}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1023}},{"source":"../../controllers/authController.js","original":{"line":47,"column":8},"generated":{"line":1,"column":1025}},{"source":"../../controllers/authController.js","name":"newUser","original":{"line":43,"column":8},"generated":{"line":1,"column":1032}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1034}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1036}},{"source":"../../controllers/authController.js","name":"url","original":{"line":45,"column":8},"generated":{"line":1,"column":1041}},{"source":"../../controllers/authController.js","name":"req","original":{"line":45,"column":17},"generated":{"line":1,"column":1043}},{"source":"../../controllers/authController.js","name":"req","original":{"line":45,"column":17},"generated":{"line":1,"column":1046}},{"source":"../../controllers/authController.js","name":"req","original":{"line":45,"column":17},"generated":{"line":1,"column":1053}},{"source":"../../controllers/authController.js","name":"protocol","original":{"line":45,"column":21},"generated":{"line":1,"column":1055}},{"source":"../../controllers/authController.js","name":"req","original":{"line":45,"column":35},"generated":{"line":1,"column":1064}},{"source":"../../controllers/authController.js","name":"req","original":{"line":45,"column":35},"generated":{"line":1,"column":1071}},{"source":"../../controllers/authController.js","name":"req","original":{"line":45,"column":35},"generated":{"line":1,"column":1078}},{"source":"../../controllers/authController.js","name":"get","original":{"line":45,"column":39},"generated":{"line":1,"column":1080}},{"source":"../../controllers/authController.js","original":{"line":45,"column":43},"generated":{"line":1,"column":1084}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1092}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1099}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1101}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1106}},{"source":"../../controllers/authController.js","original":{"line":47,"column":8},"generated":{"line":1,"column":1108}},{"source":"../../controllers/authController.js","name":"Email","original":{"line":47,"column":12},"generated":{"line":1,"column":1112}},{"source":"../../controllers/authController.js","name":"newUser","original":{"line":47,"column":18},"generated":{"line":1,"column":1114}},{"source":"../../controllers/authController.js","name":"url","original":{"line":47,"column":27},"generated":{"line":1,"column":1116}},{"source":"../../controllers/authController.js","name":"sendWelcome","original":{"line":47,"column":32},"generated":{"line":1,"column":1119}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1133}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1138}},{"source":"../../controllers/authController.js","name":"createSendToken","original":{"line":49,"column":2},"generated":{"line":1,"column":1140}},{"source":"../../controllers/authController.js","name":"newUser","original":{"line":49,"column":18},"generated":{"line":1,"column":1142}},{"source":"../../controllers/authController.js","original":{"line":49,"column":27},"generated":{"line":1,"column":1144}},{"source":"../../controllers/authController.js","name":"req","original":{"line":49,"column":32},"generated":{"line":1,"column":1148}},{"source":"../../controllers/authController.js","name":"res","original":{"line":49,"column":37},"generated":{"line":1,"column":1150}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1153}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1158}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1160}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1164}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1170}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1177}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1179}},{"source":"../../controllers/authController.js","original":{"line":42,"column":28},"generated":{"line":1,"column":1188}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1194}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1201}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1210}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1212}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1214}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1217}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1224}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1226}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1232}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1237}},{"source":"../../controllers/authController.js","original":{"line":42,"column":27},"generated":{"line":1,"column":1249}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":52,"column":0},"generated":{"line":1,"column":1253}},{"source":"../../controllers/authController.js","name":"login","original":{"line":52,"column":8},"generated":{"line":1,"column":1261}},{"source":"../../controllers/authController.js","name":"catchAsync","original":{"line":52,"column":16},"generated":{"line":1,"column":1267}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1269}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1280}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1284}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1286}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1288}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1307}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1312}},{"source":"../../controllers/authController.js","name":"req","original":{"line":52,"column":34},"generated":{"line":1,"column":1321}},{"source":"../../controllers/authController.js","name":"req","original":{"line":52,"column":34},"generated":{"line":1,"column":1323}},{"source":"../../controllers/authController.js","name":"res","original":{"line":52,"column":39},"generated":{"line":1,"column":1325}},{"source":"../../controllers/authController.js","name":"next","original":{"line":52,"column":44},"generated":{"line":1,"column":1327}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1330}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1334}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1336}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1338}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1340}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1342}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1349}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1368}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1373}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1382}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1385}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1392}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1399}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1401}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1406}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1408}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1414}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1419}},{"source":"../../controllers/authController.js","original":{"line":55,"column":6},"generated":{"line":1,"column":1421}},{"source":"../../controllers/authController.js","name":"req","original":{"line":53,"column":30},"generated":{"line":1,"column":1424}},{"source":"../../controllers/authController.js","name":"req","original":{"line":53,"column":30},"generated":{"line":1,"column":1426}},{"source":"../../controllers/authController.js","name":"body","original":{"line":53,"column":34},"generated":{"line":1,"column":1428}},{"source":"../../controllers/authController.js","name":"email","original":{"line":53,"column":10},"generated":{"line":1,"column":1433}},{"source":"../../controllers/authController.js","name":"email","original":{"line":53,"column":10},"generated":{"line":1,"column":1435}},{"source":"../../controllers/authController.js","name":"email","original":{"line":53,"column":10},"generated":{"line":1,"column":1437}},{"source":"../../controllers/authController.js","name":"password","original":{"line":53,"column":17},"generated":{"line":1,"column":1443}},{"source":"../../controllers/authController.js","name":"password","original":{"line":53,"column":17},"generated":{"line":1,"column":1445}},{"source":"../../controllers/authController.js","name":"password","original":{"line":53,"column":17},"generated":{"line":1,"column":1447}},{"source":"../../controllers/authController.js","name":"email","original":{"line":55,"column":7},"generated":{"line":1,"column":1456}},{"source":"../../controllers/authController.js","name":"password","original":{"line":55,"column":17},"generated":{"line":1,"column":1459}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1461}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1462}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1464}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1469}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1471}},{"source":"../../controllers/authController.js","name":"next","original":{"line":56,"column":11},"generated":{"line":1,"column":1477}},{"source":"../../controllers/authController.js","name":"next","original":{"line":56,"column":11},"generated":{"line":1,"column":1484}},{"source":"../../controllers/authController.js","name":"next","original":{"line":56,"column":11},"generated":{"line":1,"column":1486}},{"source":"../../controllers/authController.js","name":"next","original":{"line":56,"column":11},"generated":{"line":1,"column":1493}},{"source":"../../controllers/authController.js","name":"next","original":{"line":56,"column":11},"generated":{"line":1,"column":1502}},{"source":"../../controllers/authController.js","original":{"line":56,"column":16},"generated":{"line":1,"column":1504}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":56,"column":20},"generated":{"line":1,"column":1508}},{"source":"../../controllers/authController.js","original":{"line":56,"column":29},"generated":{"line":1,"column":1510}},{"source":"../../controllers/authController.js","original":{"line":56,"column":70},"generated":{"line":1,"column":1550}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1557}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1562}},{"source":"../../controllers/authController.js","name":"User","original":{"line":58,"column":21},"generated":{"line":1,"column":1564}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1571}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1573}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1578}},{"source":"../../controllers/authController.js","name":"User","original":{"line":58,"column":21},"generated":{"line":1,"column":1580}},{"source":"../../controllers/authController.js","name":"findOne","original":{"line":58,"column":26},"generated":{"line":1,"column":1582}},{"source":"../../controllers/authController.js","original":{"line":58,"column":34},"generated":{"line":1,"column":1590}},{"source":"../../controllers/authController.js","name":"email","original":{"line":58,"column":36},"generated":{"line":1,"column":1591}},{"source":"../../controllers/authController.js","name":"email","original":{"line":58,"column":36},"generated":{"line":1,"column":1597}},{"source":"../../controllers/authController.js","name":"select","original":{"line":58,"column":45},"generated":{"line":1,"column":1601}},{"source":"../../controllers/authController.js","original":{"line":58,"column":52},"generated":{"line":1,"column":1608}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1621}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1626}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1628}},{"source":"../../controllers/authController.js","name":"user","original":{"line":58,"column":8},"generated":{"line":1,"column":1631}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1633}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1635}},{"source":"../../controllers/authController.js","original":{"line":60,"column":6},"generated":{"line":1,"column":1640}},{"source":"../../controllers/authController.js","original":{"line":60,"column":6},"generated":{"line":1,"column":1642}},{"source":"../../controllers/authController.js","name":"user","original":{"line":60,"column":7},"generated":{"line":1,"column":1646}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1648}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1650}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1653}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1654}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1656}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1661}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1664}},{"source":"../../controllers/authController.js","name":"user","original":{"line":60,"column":23},"generated":{"line":1,"column":1670}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1677}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1679}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1684}},{"source":"../../controllers/authController.js","name":"user","original":{"line":60,"column":23},"generated":{"line":1,"column":1687}},{"source":"../../controllers/authController.js","name":"correctPassword","original":{"line":60,"column":28},"generated":{"line":1,"column":1689}},{"source":"../../controllers/authController.js","name":"password","original":{"line":60,"column":44},"generated":{"line":1,"column":1705}},{"source":"../../controllers/authController.js","name":"user","original":{"line":60,"column":54},"generated":{"line":1,"column":1707}},{"source":"../../controllers/authController.js","name":"password","original":{"line":60,"column":59},"generated":{"line":1,"column":1709}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1719}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1724}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1727}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1729}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1733}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1735}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1740}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1745}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1748}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1752}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1754}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1757}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1758}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1760}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1765}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1768}},{"source":"../../controllers/authController.js","name":"next","original":{"line":61,"column":11},"generated":{"line":1,"column":1774}},{"source":"../../controllers/authController.js","name":"next","original":{"line":61,"column":11},"generated":{"line":1,"column":1781}},{"source":"../../controllers/authController.js","name":"next","original":{"line":61,"column":11},"generated":{"line":1,"column":1783}},{"source":"../../controllers/authController.js","name":"next","original":{"line":61,"column":11},"generated":{"line":1,"column":1790}},{"source":"../../controllers/authController.js","name":"next","original":{"line":61,"column":11},"generated":{"line":1,"column":1799}},{"source":"../../controllers/authController.js","original":{"line":61,"column":16},"generated":{"line":1,"column":1801}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":61,"column":20},"generated":{"line":1,"column":1805}},{"source":"../../controllers/authController.js","original":{"line":61,"column":29},"generated":{"line":1,"column":1807}},{"source":"../../controllers/authController.js","original":{"line":61,"column":58},"generated":{"line":1,"column":1835}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1842}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1847}},{"source":"../../controllers/authController.js","name":"createSendToken","original":{"line":63,"column":2},"generated":{"line":1,"column":1850}},{"source":"../../controllers/authController.js","name":"user","original":{"line":63,"column":18},"generated":{"line":1,"column":1852}},{"source":"../../controllers/authController.js","original":{"line":63,"column":24},"generated":{"line":1,"column":1854}},{"source":"../../controllers/authController.js","name":"req","original":{"line":63,"column":29},"generated":{"line":1,"column":1858}},{"source":"../../controllers/authController.js","name":"res","original":{"line":63,"column":34},"generated":{"line":1,"column":1860}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1863}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1868}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1871}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1875}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1881}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1888}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1890}},{"source":"../../controllers/authController.js","original":{"line":52,"column":27},"generated":{"line":1,"column":1899}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1905}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1912}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1921}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1923}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1925}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1928}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1935}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1937}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1943}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1948}},{"source":"../../controllers/authController.js","original":{"line":52,"column":26},"generated":{"line":1,"column":1960}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":66,"column":0},"generated":{"line":1,"column":1964}},{"source":"../../controllers/authController.js","name":"logout","original":{"line":66,"column":8},"generated":{"line":1,"column":1972}},{"source":"../../controllers/authController.js","original":{"line":66,"column":17},"generated":{"line":1,"column":1979}},{"source":"../../controllers/authController.js","name":"req","original":{"line":66,"column":18},"generated":{"line":1,"column":1988}},{"source":"../../controllers/authController.js","name":"res","original":{"line":66,"column":23},"generated":{"line":1,"column":1990}},{"source":"../../controllers/authController.js","name":"res","original":{"line":67,"column":2},"generated":{"line":1,"column":1993}},{"source":"../../controllers/authController.js","name":"cookie","original":{"line":67,"column":6},"generated":{"line":1,"column":1995}},{"source":"../../controllers/authController.js","original":{"line":67,"column":13},"generated":{"line":1,"column":2002}},{"source":"../../controllers/authController.js","original":{"line":67,"column":20},"generated":{"line":1,"column":2008}},{"source":"../../controllers/authController.js","original":{"line":67,"column":33},"generated":{"line":1,"column":2020}},{"source":"../../controllers/authController.js","name":"expires","original":{"line":68,"column":4},"generated":{"line":1,"column":2021}},{"source":"../../controllers/authController.js","original":{"line":68,"column":13},"generated":{"line":1,"column":2029}},{"source":"../../controllers/authController.js","name":"Date","original":{"line":68,"column":17},"generated":{"line":1,"column":2033}},{"source":"../../controllers/authController.js","name":"Date","original":{"line":68,"column":22},"generated":{"line":1,"column":2038}},{"source":"../../controllers/authController.js","name":"now","original":{"line":68,"column":27},"generated":{"line":1,"column":2043}},{"source":"../../controllers/authController.js","original":{"line":68,"column":35},"generated":{"line":1,"column":2049}},{"source":"../../controllers/authController.js","name":"httpOnly","original":{"line":69,"column":4},"generated":{"line":1,"column":2054}},{"source":"../../controllers/authController.js","original":{"line":69,"column":14},"generated":{"line":1,"column":2064}},{"source":"../../controllers/authController.js","name":"res","original":{"line":72,"column":2},"generated":{"line":1,"column":2068}},{"source":"../../controllers/authController.js","name":"status","original":{"line":72,"column":6},"generated":{"line":1,"column":2070}},{"source":"../../controllers/authController.js","original":{"line":72,"column":13},"generated":{"line":1,"column":2077}},{"source":"../../controllers/authController.js","name":"json","original":{"line":72,"column":18},"generated":{"line":1,"column":2082}},{"source":"../../controllers/authController.js","original":{"line":72,"column":23},"generated":{"line":1,"column":2087}},{"source":"../../controllers/authController.js","name":"status","original":{"line":72,"column":25},"generated":{"line":1,"column":2088}},{"source":"../../controllers/authController.js","original":{"line":72,"column":33},"generated":{"line":1,"column":2095}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":75,"column":0},"generated":{"line":1,"column":2108}},{"source":"../../controllers/authController.js","name":"protect","original":{"line":75,"column":8},"generated":{"line":1,"column":2116}},{"source":"../../controllers/authController.js","name":"catchAsync","original":{"line":75,"column":18},"generated":{"line":1,"column":2124}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2126}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2137}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2141}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2143}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2145}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2164}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2169}},{"source":"../../controllers/authController.js","name":"req","original":{"line":75,"column":36},"generated":{"line":1,"column":2178}},{"source":"../../controllers/authController.js","name":"req","original":{"line":75,"column":36},"generated":{"line":1,"column":2180}},{"source":"../../controllers/authController.js","name":"res","original":{"line":75,"column":41},"generated":{"line":1,"column":2182}},{"source":"../../controllers/authController.js","name":"next","original":{"line":75,"column":46},"generated":{"line":1,"column":2184}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2187}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2191}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2193}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2195}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2197}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2204}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2223}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2228}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2237}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2240}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2247}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2254}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2256}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2261}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2263}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2269}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2274}},{"source":"../../controllers/authController.js","name":"token","original":{"line":87,"column":7},"generated":{"line":1,"column":2276}},{"source":"../../controllers/authController.js","name":"req","original":{"line":79,"column":4},"generated":{"line":1,"column":2279}},{"source":"../../controllers/authController.js","name":"headers","original":{"line":79,"column":8},"generated":{"line":1,"column":2281}},{"source":"../../controllers/authController.js","name":"authorization","original":{"line":79,"column":16},"generated":{"line":1,"column":2289}},{"source":"../../controllers/authController.js","name":"req","original":{"line":80,"column":4},"generated":{"line":1,"column":2304}},{"source":"../../controllers/authController.js","name":"headers","original":{"line":80,"column":8},"generated":{"line":1,"column":2306}},{"source":"../../controllers/authController.js","name":"authorization","original":{"line":80,"column":16},"generated":{"line":1,"column":2314}},{"source":"../../controllers/authController.js","name":"startsWith","original":{"line":80,"column":30},"generated":{"line":1,"column":2328}},{"source":"../../controllers/authController.js","original":{"line":80,"column":41},"generated":{"line":1,"column":2339}},{"source":"../../controllers/authController.js","name":"token","original":{"line":82,"column":4},"generated":{"line":1,"column":2349}},{"source":"../../controllers/authController.js","name":"req","original":{"line":82,"column":12},"generated":{"line":1,"column":2351}},{"source":"../../controllers/authController.js","name":"headers","original":{"line":82,"column":16},"generated":{"line":1,"column":2353}},{"source":"../../controllers/authController.js","name":"authorization","original":{"line":82,"column":24},"generated":{"line":1,"column":2361}},{"source":"../../controllers/authController.js","name":"replace","original":{"line":82,"column":38},"generated":{"line":1,"column":2375}},{"source":"../../controllers/authController.js","original":{"line":82,"column":46},"generated":{"line":1,"column":2383}},{"source":"../../controllers/authController.js","original":{"line":82,"column":57},"generated":{"line":1,"column":2393}},{"source":"../../controllers/authController.js","name":"req","original":{"line":83,"column":13},"generated":{"line":1,"column":2397}},{"source":"../../controllers/authController.js","name":"cookies","original":{"line":83,"column":17},"generated":{"line":1,"column":2399}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":83,"column":25},"generated":{"line":1,"column":2407}},{"source":"../../controllers/authController.js","name":"token","original":{"line":84,"column":4},"generated":{"line":1,"column":2413}},{"source":"../../controllers/authController.js","name":"req","original":{"line":84,"column":12},"generated":{"line":1,"column":2415}},{"source":"../../controllers/authController.js","name":"cookies","original":{"line":84,"column":16},"generated":{"line":1,"column":2417}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":84,"column":24},"generated":{"line":1,"column":2425}},{"source":"../../controllers/authController.js","name":"token","original":{"line":87,"column":7},"generated":{"line":1,"column":2430}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2432}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2433}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2435}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2440}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2442}},{"source":"../../controllers/authController.js","name":"next","original":{"line":88,"column":11},"generated":{"line":1,"column":2448}},{"source":"../../controllers/authController.js","name":"next","original":{"line":88,"column":11},"generated":{"line":1,"column":2455}},{"source":"../../controllers/authController.js","name":"next","original":{"line":88,"column":11},"generated":{"line":1,"column":2457}},{"source":"../../controllers/authController.js","name":"next","original":{"line":88,"column":11},"generated":{"line":1,"column":2464}},{"source":"../../controllers/authController.js","name":"next","original":{"line":88,"column":11},"generated":{"line":1,"column":2473}},{"source":"../../controllers/authController.js","original":{"line":89,"column":6},"generated":{"line":1,"column":2475}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":89,"column":10},"generated":{"line":1,"column":2479}},{"source":"../../controllers/authController.js","original":{"line":89,"column":19},"generated":{"line":1,"column":2481}},{"source":"../../controllers/authController.js","original":{"line":89,"column":73},"generated":{"line":1,"column":2534}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2541}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2546}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":92,"column":24},"generated":{"line":1,"column":2548}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2555}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2557}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2562}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":92,"column":24},"generated":{"line":1,"column":2564}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":92,"column":34},"generated":{"line":1,"column":2566}},{"source":"../../controllers/authController.js","name":"verify","original":{"line":92,"column":38},"generated":{"line":1,"column":2568}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":92,"column":24},"generated":{"line":1,"column":2575}},{"source":"../../controllers/authController.js","name":"token","original":{"line":92,"column":46},"generated":{"line":1,"column":2576}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2583}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2586}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2591}},{"source":"../../controllers/authController.js","name":"User","original":{"line":95,"column":28},"generated":{"line":1,"column":2593}},{"source":"../../controllers/authController.js","name":"decoded","original":{"line":92,"column":8},"generated":{"line":1,"column":2600}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2602}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2604}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2609}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2611}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2616}},{"source":"../../controllers/authController.js","name":"User","original":{"line":95,"column":28},"generated":{"line":1,"column":2618}},{"source":"../../controllers/authController.js","name":"findById","original":{"line":95,"column":33},"generated":{"line":1,"column":2620}},{"source":"../../controllers/authController.js","name":"decoded","original":{"line":95,"column":42},"generated":{"line":1,"column":2629}},{"source":"../../controllers/authController.js","name":"id","original":{"line":95,"column":50},"generated":{"line":1,"column":2631}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2635}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2640}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":103,"column":6},"generated":{"line":1,"column":2642}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":95,"column":8},"generated":{"line":1,"column":2646}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2648}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2650}},{"source":"../../controllers/authController.js","name":"next","original":{"line":98,"column":4},"generated":{"line":1,"column":2657}},{"source":"../../controllers/authController.js","original":{"line":99,"column":6},"generated":{"line":1,"column":2659}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":99,"column":10},"generated":{"line":1,"column":2663}},{"source":"../../controllers/authController.js","original":{"line":99,"column":19},"generated":{"line":1,"column":2665}},{"source":"../../controllers/authController.js","original":{"line":99,"column":76},"generated":{"line":1,"column":2721}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":103,"column":6},"generated":{"line":1,"column":2728}},{"source":"../../controllers/authController.js","name":"changedPasswordAfter","original":{"line":103,"column":18},"generated":{"line":1,"column":2730}},{"source":"../../controllers/authController.js","name":"decoded","original":{"line":103,"column":39},"generated":{"line":1,"column":2751}},{"source":"../../controllers/authController.js","name":"iat","original":{"line":103,"column":47},"generated":{"line":1,"column":2753}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2758}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2759}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2761}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2766}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2769}},{"source":"../../controllers/authController.js","name":"next","original":{"line":104,"column":11},"generated":{"line":1,"column":2775}},{"source":"../../controllers/authController.js","name":"next","original":{"line":104,"column":11},"generated":{"line":1,"column":2782}},{"source":"../../controllers/authController.js","name":"next","original":{"line":104,"column":11},"generated":{"line":1,"column":2784}},{"source":"../../controllers/authController.js","name":"next","original":{"line":104,"column":11},"generated":{"line":1,"column":2791}},{"source":"../../controllers/authController.js","name":"next","original":{"line":104,"column":11},"generated":{"line":1,"column":2800}},{"source":"../../controllers/authController.js","original":{"line":105,"column":6},"generated":{"line":1,"column":2802}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":105,"column":10},"generated":{"line":1,"column":2806}},{"source":"../../controllers/authController.js","original":{"line":105,"column":19},"generated":{"line":1,"column":2808}},{"source":"../../controllers/authController.js","original":{"line":105,"column":74},"generated":{"line":1,"column":2862}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2869}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2874}},{"source":"../../controllers/authController.js","name":"req","original":{"line":109,"column":2},"generated":{"line":1,"column":2877}},{"source":"../../controllers/authController.js","name":"user","original":{"line":109,"column":6},"generated":{"line":1,"column":2879}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":109,"column":13},"generated":{"line":1,"column":2884}},{"source":"../../controllers/authController.js","name":"res","original":{"line":110,"column":2},"generated":{"line":1,"column":2886}},{"source":"../../controllers/authController.js","name":"locals","original":{"line":110,"column":6},"generated":{"line":1,"column":2888}},{"source":"../../controllers/authController.js","name":"user","original":{"line":110,"column":13},"generated":{"line":1,"column":2895}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":110,"column":20},"generated":{"line":1,"column":2900}},{"source":"../../controllers/authController.js","name":"next","original":{"line":112,"column":2},"generated":{"line":1,"column":2902}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2906}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2911}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2914}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2918}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2924}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2931}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2933}},{"source":"../../controllers/authController.js","original":{"line":75,"column":29},"generated":{"line":1,"column":2942}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2948}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2955}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2964}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2966}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2968}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2971}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2978}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2980}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2986}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":2991}},{"source":"../../controllers/authController.js","original":{"line":75,"column":28},"generated":{"line":1,"column":3003}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":115,"column":0},"generated":{"line":1,"column":3007}},{"source":"../../controllers/authController.js","name":"isLoggedIn","original":{"line":115,"column":8},"generated":{"line":1,"column":3015}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3026}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3037}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3041}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3043}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3045}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3064}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3069}},{"source":"../../controllers/authController.js","name":"req","original":{"line":115,"column":28},"generated":{"line":1,"column":3078}},{"source":"../../controllers/authController.js","name":"req","original":{"line":115,"column":28},"generated":{"line":1,"column":3080}},{"source":"../../controllers/authController.js","name":"res","original":{"line":115,"column":33},"generated":{"line":1,"column":3082}},{"source":"../../controllers/authController.js","name":"next","original":{"line":115,"column":38},"generated":{"line":1,"column":3084}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3087}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3091}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3093}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3095}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3102}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3121}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3126}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3135}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3138}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3145}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3152}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3154}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3159}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3161}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3167}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3172}},{"source":"../../controllers/authController.js","name":"req","original":{"line":116,"column":6},"generated":{"line":1,"column":3174}},{"source":"../../controllers/authController.js","name":"req","original":{"line":116,"column":6},"generated":{"line":1,"column":3178}},{"source":"../../controllers/authController.js","name":"cookies","original":{"line":116,"column":10},"generated":{"line":1,"column":3180}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":116,"column":18},"generated":{"line":1,"column":3188}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3192}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3193}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3195}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3200}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3203}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":118,"column":28},"generated":{"line":1,"column":3209}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3216}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3218}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3223}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3225}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3227}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3232}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":118,"column":28},"generated":{"line":1,"column":3234}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":118,"column":38},"generated":{"line":1,"column":3236}},{"source":"../../controllers/authController.js","name":"verify","original":{"line":118,"column":42},"generated":{"line":1,"column":3238}},{"source":"../../controllers/authController.js","name":"promisify","original":{"line":118,"column":28},"generated":{"line":1,"column":3245}},{"source":"../../controllers/authController.js","name":"req","original":{"line":119,"column":8},"generated":{"line":1,"column":3246}},{"source":"../../controllers/authController.js","name":"cookies","original":{"line":119,"column":12},"generated":{"line":1,"column":3248}},{"source":"../../controllers/authController.js","name":"jwt","original":{"line":119,"column":20},"generated":{"line":1,"column":3256}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3265}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3268}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3273}},{"source":"../../controllers/authController.js","name":"User","original":{"line":124,"column":32},"generated":{"line":1,"column":3275}},{"source":"../../controllers/authController.js","name":"decoded","original":{"line":118,"column":12},"generated":{"line":1,"column":3282}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3284}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3286}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3291}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3293}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3298}},{"source":"../../controllers/authController.js","name":"User","original":{"line":124,"column":32},"generated":{"line":1,"column":3300}},{"source":"../../controllers/authController.js","name":"findById","original":{"line":124,"column":37},"generated":{"line":1,"column":3302}},{"source":"../../controllers/authController.js","name":"decoded","original":{"line":124,"column":46},"generated":{"line":1,"column":3311}},{"source":"../../controllers/authController.js","name":"id","original":{"line":124,"column":54},"generated":{"line":1,"column":3313}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3317}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3322}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":127,"column":10},"generated":{"line":1,"column":3324}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":124,"column":12},"generated":{"line":1,"column":3329}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3331}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3333}},{"source":"../../controllers/authController.js","name":"changedPasswordAfter","original":{"line":127,"column":22},"generated":{"line":1,"column":3339}},{"source":"../../controllers/authController.js","name":"decoded","original":{"line":127,"column":43},"generated":{"line":1,"column":3360}},{"source":"../../controllers/authController.js","name":"iat","original":{"line":127,"column":51},"generated":{"line":1,"column":3362}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3367}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3368}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3370}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3375}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3378}},{"source":"../../controllers/authController.js","name":"next","original":{"line":128,"column":15},"generated":{"line":1,"column":3384}},{"source":"../../controllers/authController.js","name":"next","original":{"line":128,"column":15},"generated":{"line":1,"column":3391}},{"source":"../../controllers/authController.js","name":"next","original":{"line":128,"column":15},"generated":{"line":1,"column":3393}},{"source":"../../controllers/authController.js","name":"next","original":{"line":128,"column":15},"generated":{"line":1,"column":3400}},{"source":"../../controllers/authController.js","name":"next","original":{"line":128,"column":15},"generated":{"line":1,"column":3409}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3414}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3419}},{"source":"../../controllers/authController.js","name":"next","original":{"line":133,"column":13},"generated":{"line":1,"column":3422}},{"source":"../../controllers/authController.js","name":"res","original":{"line":131,"column":6},"generated":{"line":1,"column":3429}},{"source":"../../controllers/authController.js","name":"locals","original":{"line":131,"column":10},"generated":{"line":1,"column":3431}},{"source":"../../controllers/authController.js","name":"user","original":{"line":131,"column":17},"generated":{"line":1,"column":3438}},{"source":"../../controllers/authController.js","name":"currentUser","original":{"line":131,"column":24},"generated":{"line":1,"column":3443}},{"source":"../../controllers/authController.js","name":"next","original":{"line":133,"column":13},"generated":{"line":1,"column":3445}},{"source":"../../controllers/authController.js","name":"next","original":{"line":133,"column":13},"generated":{"line":1,"column":3447}},{"source":"../../controllers/authController.js","name":"next","original":{"line":133,"column":13},"generated":{"line":1,"column":3454}},{"source":"../../controllers/authController.js","name":"next","original":{"line":133,"column":13},"generated":{"line":1,"column":3463}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3468}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3473}},{"source":"../../controllers/authController.js","name":"next","original":{"line":135,"column":13},"generated":{"line":1,"column":3476}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3483}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3485}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3490}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3493}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3495}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3498}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3500}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3506}},{"source":"../../controllers/authController.js","name":"next","original":{"line":135,"column":13},"generated":{"line":1,"column":3509}},{"source":"../../controllers/authController.js","name":"next","original":{"line":135,"column":13},"generated":{"line":1,"column":3511}},{"source":"../../controllers/authController.js","name":"next","original":{"line":135,"column":13},"generated":{"line":1,"column":3518}},{"source":"../../controllers/authController.js","name":"next","original":{"line":135,"column":13},"generated":{"line":1,"column":3527}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3532}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3537}},{"source":"../../controllers/authController.js","name":"next","original":{"line":138,"column":2},"generated":{"line":1,"column":3540}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3544}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3549}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3552}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3556}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3562}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3569}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3571}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3580}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3582}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3587}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3588}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3589}},{"source":"../../controllers/authController.js","original":{"line":115,"column":21},"generated":{"line":1,"column":3591}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3600}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3607}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3616}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3618}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3620}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3623}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3630}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3632}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3638}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3643}},{"source":"../../controllers/authController.js","original":{"line":115,"column":0},"generated":{"line":1,"column":3655}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":141,"column":0},"generated":{"line":1,"column":3658}},{"source":"../../controllers/authController.js","name":"restrictTo","original":{"line":141,"column":8},"generated":{"line":1,"column":3666}},{"source":"../../controllers/authController.js","original":{"line":141,"column":21},"generated":{"line":1,"column":3677}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":141,"column":25},"generated":{"line":1,"column":3688}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":141,"column":25},"generated":{"line":1,"column":3692}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":141,"column":25},"generated":{"line":1,"column":3696}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":141,"column":25},"generated":{"line":1,"column":3698}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":141,"column":25},"generated":{"line":1,"column":3708}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":141,"column":25},"generated":{"line":1,"column":3715}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3717}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3721}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3727}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3730}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3732}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3734}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3736}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3738}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":141,"column":25},"generated":{"line":1,"column":3742}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3744}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3747}},{"source":"../../controllers/authController.js","original":{"line":141,"column":35},"generated":{"line":1,"column":3757}},{"source":"../../controllers/authController.js","original":{"line":142,"column":9},"generated":{"line":1,"column":3760}},{"source":"../../controllers/authController.js","original":{"line":142,"column":9},"generated":{"line":1,"column":3767}},{"source":"../../controllers/authController.js","name":"req","original":{"line":142,"column":10},"generated":{"line":1,"column":3776}},{"source":"../../controllers/authController.js","name":"res","original":{"line":142,"column":15},"generated":{"line":1,"column":3778}},{"source":"../../controllers/authController.js","name":"next","original":{"line":142,"column":20},"generated":{"line":1,"column":3780}},{"source":"../../controllers/authController.js","name":"user","original":{"line":143,"column":10},"generated":{"line":1,"column":3783}},{"source":"../../controllers/authController.js","name":"user","original":{"line":143,"column":10},"generated":{"line":1,"column":3787}},{"source":"../../controllers/authController.js","name":"req","original":{"line":143,"column":17},"generated":{"line":1,"column":3789}},{"source":"../../controllers/authController.js","name":"user","original":{"line":143,"column":21},"generated":{"line":1,"column":3791}},{"source":"../../controllers/authController.js","original":{"line":144,"column":8},"generated":{"line":1,"column":3796}},{"source":"../../controllers/authController.js","name":"roles","original":{"line":144,"column":9},"generated":{"line":1,"column":3800}},{"source":"../../controllers/authController.js","name":"includes","original":{"line":144,"column":15},"generated":{"line":1,"column":3802}},{"source":"../../controllers/authController.js","name":"user","original":{"line":144,"column":24},"generated":{"line":1,"column":3811}},{"source":"../../controllers/authController.js","name":"role","original":{"line":144,"column":29},"generated":{"line":1,"column":3813}},{"source":"../../controllers/authController.js","name":"next","original":{"line":145,"column":13},"generated":{"line":1,"column":3819}},{"source":"../../controllers/authController.js","name":"next","original":{"line":145,"column":13},"generated":{"line":1,"column":3826}},{"source":"../../controllers/authController.js","original":{"line":146,"column":8},"generated":{"line":1,"column":3828}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":146,"column":12},"generated":{"line":1,"column":3832}},{"source":"../../controllers/authController.js","original":{"line":146,"column":21},"generated":{"line":1,"column":3834}},{"source":"../../controllers/authController.js","original":{"line":146,"column":74},"generated":{"line":1,"column":3886}},{"source":"../../controllers/authController.js","name":"next","original":{"line":150,"column":4},"generated":{"line":1,"column":3892}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":154,"column":0},"generated":{"line":1,"column":3898}},{"source":"../../controllers/authController.js","name":"forgotPassword","original":{"line":154,"column":8},"generated":{"line":1,"column":3906}},{"source":"../../controllers/authController.js","name":"catchAsync","original":{"line":154,"column":25},"generated":{"line":1,"column":3921}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":3923}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3934}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3938}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3940}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3942}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3961}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3966}},{"source":"../../controllers/authController.js","name":"req","original":{"line":154,"column":43},"generated":{"line":1,"column":3975}},{"source":"../../controllers/authController.js","name":"req","original":{"line":154,"column":43},"generated":{"line":1,"column":3977}},{"source":"../../controllers/authController.js","name":"res","original":{"line":154,"column":48},"generated":{"line":1,"column":3979}},{"source":"../../controllers/authController.js","name":"next","original":{"line":154,"column":53},"generated":{"line":1,"column":3981}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3984}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3988}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3990}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3992}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":3994}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4001}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4020}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4025}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4034}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4037}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4044}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4051}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4053}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4058}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4060}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4066}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4071}},{"source":"../../controllers/authController.js","name":"User","original":{"line":155,"column":21},"generated":{"line":1,"column":4073}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4080}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4082}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4087}},{"source":"../../controllers/authController.js","name":"User","original":{"line":155,"column":21},"generated":{"line":1,"column":4089}},{"source":"../../controllers/authController.js","name":"findOne","original":{"line":155,"column":26},"generated":{"line":1,"column":4091}},{"source":"../../controllers/authController.js","original":{"line":155,"column":34},"generated":{"line":1,"column":4099}},{"source":"../../controllers/authController.js","name":"email","original":{"line":155,"column":36},"generated":{"line":1,"column":4100}},{"source":"../../controllers/authController.js","name":"req","original":{"line":155,"column":43},"generated":{"line":1,"column":4106}},{"source":"../../controllers/authController.js","name":"body","original":{"line":155,"column":47},"generated":{"line":1,"column":4108}},{"source":"../../controllers/authController.js","name":"email","original":{"line":155,"column":52},"generated":{"line":1,"column":4113}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4121}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4126}},{"source":"../../controllers/authController.js","name":"user","original":{"line":157,"column":7},"generated":{"line":1,"column":4128}},{"source":"../../controllers/authController.js","name":"user","original":{"line":155,"column":8},"generated":{"line":1,"column":4131}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4133}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4135}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4140}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4141}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4143}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4148}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4150}},{"source":"../../controllers/authController.js","name":"next","original":{"line":157,"column":20},"generated":{"line":1,"column":4156}},{"source":"../../controllers/authController.js","name":"next","original":{"line":157,"column":20},"generated":{"line":1,"column":4163}},{"source":"../../controllers/authController.js","name":"next","original":{"line":157,"column":20},"generated":{"line":1,"column":4165}},{"source":"../../controllers/authController.js","name":"next","original":{"line":157,"column":20},"generated":{"line":1,"column":4172}},{"source":"../../controllers/authController.js","name":"next","original":{"line":157,"column":20},"generated":{"line":1,"column":4181}},{"source":"../../controllers/authController.js","original":{"line":157,"column":25},"generated":{"line":1,"column":4183}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":157,"column":29},"generated":{"line":1,"column":4187}},{"source":"../../controllers/authController.js","original":{"line":157,"column":38},"generated":{"line":1,"column":4189}},{"source":"../../controllers/authController.js","original":{"line":157,"column":56},"generated":{"line":1,"column":4206}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4213}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4218}},{"source":"../../controllers/authController.js","name":"user","original":{"line":161,"column":8},"generated":{"line":1,"column":4220}},{"source":"../../controllers/authController.js","name":"resetToken","original":{"line":159,"column":8},"generated":{"line":1,"column":4227}},{"source":"../../controllers/authController.js","name":"user","original":{"line":159,"column":21},"generated":{"line":1,"column":4229}},{"source":"../../controllers/authController.js","name":"createPasswordResetToken","original":{"line":159,"column":26},"generated":{"line":1,"column":4231}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4258}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4260}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4265}},{"source":"../../controllers/authController.js","name":"user","original":{"line":161,"column":8},"generated":{"line":1,"column":4267}},{"source":"../../controllers/authController.js","name":"save","original":{"line":161,"column":13},"generated":{"line":1,"column":4269}},{"source":"../../controllers/authController.js","original":{"line":161,"column":18},"generated":{"line":1,"column":4274}},{"source":"../../controllers/authController.js","name":"validateBeforeSave","original":{"line":161,"column":20},"generated":{"line":1,"column":4275}},{"source":"../../controllers/authController.js","original":{"line":161,"column":40},"generated":{"line":1,"column":4295}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4299}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4304}},{"source":"../../controllers/authController.js","original":{"line":169,"column":10},"generated":{"line":1,"column":4306}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4313}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4315}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4320}},{"source":"../../controllers/authController.js","name":"resetURL","original":{"line":165,"column":10},"generated":{"line":1,"column":4322}},{"source":"../../controllers/authController.js","name":"req","original":{"line":165,"column":24},"generated":{"line":1,"column":4324}},{"source":"../../controllers/authController.js","name":"req","original":{"line":165,"column":24},"generated":{"line":1,"column":4327}},{"source":"../../controllers/authController.js","name":"req","original":{"line":165,"column":24},"generated":{"line":1,"column":4334}},{"source":"../../controllers/authController.js","name":"protocol","original":{"line":165,"column":28},"generated":{"line":1,"column":4336}},{"source":"../../controllers/authController.js","name":"req","original":{"line":165,"column":42},"generated":{"line":1,"column":4345}},{"source":"../../controllers/authController.js","name":"req","original":{"line":165,"column":42},"generated":{"line":1,"column":4352}},{"source":"../../controllers/authController.js","name":"req","original":{"line":165,"column":42},"generated":{"line":1,"column":4359}},{"source":"../../controllers/authController.js","name":"get","original":{"line":165,"column":46},"generated":{"line":1,"column":4361}},{"source":"../../controllers/authController.js","original":{"line":166,"column":6},"generated":{"line":1,"column":4365}},{"source":"../../controllers/authController.js","name":"resetToken","original":{"line":167,"column":36},"generated":{"line":1,"column":4373}},{"source":"../../controllers/authController.js","name":"resetToken","original":{"line":167,"column":36},"generated":{"line":1,"column":4405}},{"source":"../../controllers/authController.js","name":"resetToken","original":{"line":167,"column":36},"generated":{"line":1,"column":4412}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4415}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4417}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4422}},{"source":"../../controllers/authController.js","original":{"line":169,"column":10},"generated":{"line":1,"column":4425}},{"source":"../../controllers/authController.js","name":"Email","original":{"line":169,"column":14},"generated":{"line":1,"column":4429}},{"source":"../../controllers/authController.js","name":"user","original":{"line":169,"column":20},"generated":{"line":1,"column":4431}},{"source":"../../controllers/authController.js","name":"resetURL","original":{"line":169,"column":26},"generated":{"line":1,"column":4433}},{"source":"../../controllers/authController.js","name":"sendPasswordReset","original":{"line":169,"column":36},"generated":{"line":1,"column":4436}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4456}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4461}},{"source":"../../controllers/authController.js","name":"res","original":{"line":171,"column":4},"generated":{"line":1,"column":4464}},{"source":"../../controllers/authController.js","name":"status","original":{"line":171,"column":8},"generated":{"line":1,"column":4466}},{"source":"../../controllers/authController.js","original":{"line":171,"column":15},"generated":{"line":1,"column":4473}},{"source":"../../controllers/authController.js","name":"json","original":{"line":171,"column":20},"generated":{"line":1,"column":4478}},{"source":"../../controllers/authController.js","original":{"line":171,"column":25},"generated":{"line":1,"column":4483}},{"source":"../../controllers/authController.js","name":"status","original":{"line":172,"column":6},"generated":{"line":1,"column":4484}},{"source":"../../controllers/authController.js","original":{"line":172,"column":14},"generated":{"line":1,"column":4491}},{"source":"../../controllers/authController.js","name":"message","original":{"line":173,"column":6},"generated":{"line":1,"column":4501}},{"source":"../../controllers/authController.js","original":{"line":173,"column":15},"generated":{"line":1,"column":4509}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4533}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4535}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4540}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4543}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4549}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4554}},{"source":"../../controllers/authController.js","name":"user","original":{"line":179,"column":10},"generated":{"line":1,"column":4557}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4564}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4566}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4571}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4574}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4576}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4579}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4581}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4587}},{"source":"../../controllers/authController.js","name":"user","original":{"line":176,"column":4},"generated":{"line":1,"column":4590}},{"source":"../../controllers/authController.js","name":"passwordResetToken","original":{"line":176,"column":9},"generated":{"line":1,"column":4592}},{"source":"../../controllers/authController.js","name":"undefined","original":{"line":176,"column":30},"generated":{"line":1,"column":4616}},{"source":"../../controllers/authController.js","name":"user","original":{"line":177,"column":4},"generated":{"line":1,"column":4618}},{"source":"../../controllers/authController.js","name":"passwordResetExpires","original":{"line":177,"column":9},"generated":{"line":1,"column":4620}},{"source":"../../controllers/authController.js","name":"undefined","original":{"line":177,"column":32},"generated":{"line":1,"column":4646}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4648}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4650}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4655}},{"source":"../../controllers/authController.js","name":"user","original":{"line":179,"column":10},"generated":{"line":1,"column":4658}},{"source":"../../controllers/authController.js","name":"save","original":{"line":179,"column":15},"generated":{"line":1,"column":4660}},{"source":"../../controllers/authController.js","original":{"line":179,"column":20},"generated":{"line":1,"column":4665}},{"source":"../../controllers/authController.js","name":"validateBeforeSave","original":{"line":179,"column":22},"generated":{"line":1,"column":4666}},{"source":"../../controllers/authController.js","original":{"line":179,"column":42},"generated":{"line":1,"column":4686}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4690}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4695}},{"source":"../../controllers/authController.js","name":"next","original":{"line":181,"column":11},"generated":{"line":1,"column":4698}},{"source":"../../controllers/authController.js","name":"next","original":{"line":181,"column":11},"generated":{"line":1,"column":4705}},{"source":"../../controllers/authController.js","name":"next","original":{"line":181,"column":11},"generated":{"line":1,"column":4707}},{"source":"../../controllers/authController.js","name":"next","original":{"line":181,"column":11},"generated":{"line":1,"column":4714}},{"source":"../../controllers/authController.js","name":"next","original":{"line":181,"column":11},"generated":{"line":1,"column":4723}},{"source":"../../controllers/authController.js","original":{"line":182,"column":6},"generated":{"line":1,"column":4725}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":182,"column":10},"generated":{"line":1,"column":4729}},{"source":"../../controllers/authController.js","original":{"line":183,"column":8},"generated":{"line":1,"column":4731}},{"source":"../../controllers/authController.js","original":{"line":184,"column":8},"generated":{"line":1,"column":4788}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4795}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4800}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4803}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4807}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4813}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4820}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4822}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4831}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4833}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4838}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4839}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4840}},{"source":"../../controllers/authController.js","original":{"line":154,"column":36},"generated":{"line":1,"column":4842}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4851}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4858}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4867}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4869}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4871}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4874}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4881}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4883}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4889}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4894}},{"source":"../../controllers/authController.js","original":{"line":154,"column":35},"generated":{"line":1,"column":4906}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":190,"column":0},"generated":{"line":1,"column":4910}},{"source":"../../controllers/authController.js","name":"resetPassword","original":{"line":190,"column":8},"generated":{"line":1,"column":4918}},{"source":"../../controllers/authController.js","name":"catchAsync","original":{"line":190,"column":24},"generated":{"line":1,"column":4932}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":4934}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4945}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4949}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4951}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4953}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4972}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4977}},{"source":"../../controllers/authController.js","name":"req","original":{"line":190,"column":42},"generated":{"line":1,"column":4986}},{"source":"../../controllers/authController.js","name":"req","original":{"line":190,"column":42},"generated":{"line":1,"column":4988}},{"source":"../../controllers/authController.js","name":"res","original":{"line":190,"column":47},"generated":{"line":1,"column":4990}},{"source":"../../controllers/authController.js","name":"next","original":{"line":190,"column":52},"generated":{"line":1,"column":4992}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4995}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":4999}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5001}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5003}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5010}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5029}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5034}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5043}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5046}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5053}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5060}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5062}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5067}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5069}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5075}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5080}},{"source":"../../controllers/authController.js","name":"User","original":{"line":196,"column":21},"generated":{"line":1,"column":5082}},{"source":"../../controllers/authController.js","name":"hashedToken","original":{"line":191,"column":8},"generated":{"line":1,"column":5089}},{"source":"../../controllers/authController.js","name":"crypto","original":{"line":191,"column":22},"generated":{"line":1,"column":5091}},{"source":"../../controllers/authController.js","name":"createHash","original":{"line":192,"column":5},"generated":{"line":1,"column":5093}},{"source":"../../controllers/authController.js","original":{"line":192,"column":16},"generated":{"line":1,"column":5104}},{"source":"../../controllers/authController.js","name":"update","original":{"line":193,"column":5},"generated":{"line":1,"column":5114}},{"source":"../../controllers/authController.js","name":"req","original":{"line":193,"column":12},"generated":{"line":1,"column":5121}},{"source":"../../controllers/authController.js","name":"params","original":{"line":193,"column":16},"generated":{"line":1,"column":5123}},{"source":"../../controllers/authController.js","name":"token","original":{"line":193,"column":23},"generated":{"line":1,"column":5130}},{"source":"../../controllers/authController.js","name":"digest","original":{"line":194,"column":5},"generated":{"line":1,"column":5137}},{"source":"../../controllers/authController.js","original":{"line":194,"column":12},"generated":{"line":1,"column":5144}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5151}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5153}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5158}},{"source":"../../controllers/authController.js","name":"User","original":{"line":196,"column":21},"generated":{"line":1,"column":5160}},{"source":"../../controllers/authController.js","name":"findOne","original":{"line":196,"column":26},"generated":{"line":1,"column":5162}},{"source":"../../controllers/authController.js","original":{"line":196,"column":34},"generated":{"line":1,"column":5170}},{"source":"../../controllers/authController.js","name":"passwordResetToken","original":{"line":197,"column":4},"generated":{"line":1,"column":5171}},{"source":"../../controllers/authController.js","name":"hashedToken","original":{"line":197,"column":24},"generated":{"line":1,"column":5190}},{"source":"../../controllers/authController.js","name":"passwordResetExpires","original":{"line":198,"column":4},"generated":{"line":1,"column":5192}},{"source":"../../controllers/authController.js","original":{"line":198,"column":26},"generated":{"line":1,"column":5213}},{"source":"../../controllers/authController.js","name":"$gt","original":{"line":198,"column":28},"generated":{"line":1,"column":5214}},{"source":"../../controllers/authController.js","name":"Date","original":{"line":198,"column":33},"generated":{"line":1,"column":5218}},{"source":"../../controllers/authController.js","name":"now","original":{"line":198,"column":38},"generated":{"line":1,"column":5223}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5232}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5237}},{"source":"../../controllers/authController.js","name":"user","original":{"line":201,"column":7},"generated":{"line":1,"column":5239}},{"source":"../../controllers/authController.js","name":"user","original":{"line":196,"column":8},"generated":{"line":1,"column":5242}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5244}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5246}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5251}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5252}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5254}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5259}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5261}},{"source":"../../controllers/authController.js","name":"next","original":{"line":201,"column":20},"generated":{"line":1,"column":5267}},{"source":"../../controllers/authController.js","name":"next","original":{"line":201,"column":20},"generated":{"line":1,"column":5274}},{"source":"../../controllers/authController.js","name":"next","original":{"line":201,"column":20},"generated":{"line":1,"column":5276}},{"source":"../../controllers/authController.js","name":"next","original":{"line":201,"column":20},"generated":{"line":1,"column":5283}},{"source":"../../controllers/authController.js","name":"next","original":{"line":201,"column":20},"generated":{"line":1,"column":5292}},{"source":"../../controllers/authController.js","original":{"line":201,"column":25},"generated":{"line":1,"column":5294}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":201,"column":29},"generated":{"line":1,"column":5298}},{"source":"../../controllers/authController.js","original":{"line":201,"column":38},"generated":{"line":1,"column":5300}},{"source":"../../controllers/authController.js","original":{"line":201,"column":73},"generated":{"line":1,"column":5334}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5341}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5346}},{"source":"../../controllers/authController.js","name":"user","original":{"line":209,"column":8},"generated":{"line":1,"column":5348}},{"source":"../../controllers/authController.js","name":"user","original":{"line":203,"column":2},"generated":{"line":1,"column":5355}},{"source":"../../controllers/authController.js","name":"password","original":{"line":203,"column":7},"generated":{"line":1,"column":5357}},{"source":"../../controllers/authController.js","name":"req","original":{"line":203,"column":18},"generated":{"line":1,"column":5366}},{"source":"../../controllers/authController.js","name":"body","original":{"line":203,"column":22},"generated":{"line":1,"column":5368}},{"source":"../../controllers/authController.js","name":"password","original":{"line":203,"column":27},"generated":{"line":1,"column":5373}},{"source":"../../controllers/authController.js","name":"user","original":{"line":204,"column":2},"generated":{"line":1,"column":5382}},{"source":"../../controllers/authController.js","name":"passwordConfirm","original":{"line":204,"column":7},"generated":{"line":1,"column":5384}},{"source":"../../controllers/authController.js","name":"req","original":{"line":204,"column":25},"generated":{"line":1,"column":5400}},{"source":"../../controllers/authController.js","name":"body","original":{"line":204,"column":29},"generated":{"line":1,"column":5402}},{"source":"../../controllers/authController.js","name":"passwordConfirm","original":{"line":204,"column":34},"generated":{"line":1,"column":5407}},{"source":"../../controllers/authController.js","name":"user","original":{"line":206,"column":2},"generated":{"line":1,"column":5423}},{"source":"../../controllers/authController.js","name":"passwordResetExpires","original":{"line":206,"column":7},"generated":{"line":1,"column":5425}},{"source":"../../controllers/authController.js","name":"undefined","original":{"line":206,"column":30},"generated":{"line":1,"column":5451}},{"source":"../../controllers/authController.js","name":"user","original":{"line":207,"column":2},"generated":{"line":1,"column":5453}},{"source":"../../controllers/authController.js","name":"passwordResetToken","original":{"line":207,"column":7},"generated":{"line":1,"column":5455}},{"source":"../../controllers/authController.js","name":"undefined","original":{"line":207,"column":28},"generated":{"line":1,"column":5479}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5481}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5483}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5488}},{"source":"../../controllers/authController.js","name":"user","original":{"line":209,"column":8},"generated":{"line":1,"column":5491}},{"source":"../../controllers/authController.js","name":"save","original":{"line":209,"column":13},"generated":{"line":1,"column":5493}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5500}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5505}},{"source":"../../controllers/authController.js","name":"createSendToken","original":{"line":213,"column":2},"generated":{"line":1,"column":5508}},{"source":"../../controllers/authController.js","name":"user","original":{"line":213,"column":18},"generated":{"line":1,"column":5510}},{"source":"../../controllers/authController.js","original":{"line":213,"column":24},"generated":{"line":1,"column":5512}},{"source":"../../controllers/authController.js","name":"req","original":{"line":213,"column":29},"generated":{"line":1,"column":5516}},{"source":"../../controllers/authController.js","name":"res","original":{"line":213,"column":34},"generated":{"line":1,"column":5518}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5521}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5526}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5529}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5533}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5539}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5546}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5548}},{"source":"../../controllers/authController.js","original":{"line":190,"column":35},"generated":{"line":1,"column":5557}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5563}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5570}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5579}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5581}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5583}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5586}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5593}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5595}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5601}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5606}},{"source":"../../controllers/authController.js","original":{"line":190,"column":34},"generated":{"line":1,"column":5618}},{"source":"../../controllers/authController.js","name":"exports","original":{"line":216,"column":0},"generated":{"line":1,"column":5622}},{"source":"../../controllers/authController.js","name":"updatePassword","original":{"line":216,"column":8},"generated":{"line":1,"column":5630}},{"source":"../../controllers/authController.js","name":"catchAsync","original":{"line":216,"column":25},"generated":{"line":1,"column":5645}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":5647}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5658}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5662}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5664}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5666}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5685}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5690}},{"source":"../../controllers/authController.js","name":"req","original":{"line":216,"column":43},"generated":{"line":1,"column":5699}},{"source":"../../controllers/authController.js","name":"req","original":{"line":216,"column":43},"generated":{"line":1,"column":5701}},{"source":"../../controllers/authController.js","name":"res","original":{"line":216,"column":48},"generated":{"line":1,"column":5703}},{"source":"../../controllers/authController.js","name":"next","original":{"line":216,"column":53},"generated":{"line":1,"column":5705}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5708}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5712}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5714}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5721}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5740}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5745}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5754}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5757}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5764}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5771}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5773}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5778}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5780}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5786}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5791}},{"source":"../../controllers/authController.js","name":"User","original":{"line":217,"column":21},"generated":{"line":1,"column":5793}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5800}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5802}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5807}},{"source":"../../controllers/authController.js","name":"User","original":{"line":217,"column":21},"generated":{"line":1,"column":5809}},{"source":"../../controllers/authController.js","name":"findById","original":{"line":217,"column":26},"generated":{"line":1,"column":5811}},{"source":"../../controllers/authController.js","name":"req","original":{"line":217,"column":35},"generated":{"line":1,"column":5820}},{"source":"../../controllers/authController.js","name":"user","original":{"line":217,"column":39},"generated":{"line":1,"column":5822}},{"source":"../../controllers/authController.js","name":"id","original":{"line":217,"column":44},"generated":{"line":1,"column":5827}},{"source":"../../controllers/authController.js","name":"select","original":{"line":217,"column":48},"generated":{"line":1,"column":5831}},{"source":"../../controllers/authController.js","original":{"line":217,"column":55},"generated":{"line":1,"column":5838}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5851}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5856}},{"source":"../../controllers/authController.js","name":"user","original":{"line":219,"column":14},"generated":{"line":1,"column":5858}},{"source":"../../controllers/authController.js","name":"user","original":{"line":217,"column":8},"generated":{"line":1,"column":5865}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5867}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5869}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5874}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5876}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5881}},{"source":"../../controllers/authController.js","name":"user","original":{"line":219,"column":14},"generated":{"line":1,"column":5883}},{"source":"../../controllers/authController.js","name":"correctPassword","original":{"line":219,"column":19},"generated":{"line":1,"column":5885}},{"source":"../../controllers/authController.js","name":"req","original":{"line":219,"column":35},"generated":{"line":1,"column":5901}},{"source":"../../controllers/authController.js","name":"body","original":{"line":219,"column":39},"generated":{"line":1,"column":5903}},{"source":"../../controllers/authController.js","name":"passwordCurrent","original":{"line":219,"column":44},"generated":{"line":1,"column":5908}},{"source":"../../controllers/authController.js","name":"user","original":{"line":219,"column":61},"generated":{"line":1,"column":5924}},{"source":"../../controllers/authController.js","name":"password","original":{"line":219,"column":66},"generated":{"line":1,"column":5926}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5936}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5941}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5943}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5946}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5948}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5953}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5954}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5956}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5961}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":5963}},{"source":"../../controllers/authController.js","name":"next","original":{"line":220,"column":11},"generated":{"line":1,"column":5969}},{"source":"../../controllers/authController.js","name":"next","original":{"line":220,"column":11},"generated":{"line":1,"column":5976}},{"source":"../../controllers/authController.js","name":"next","original":{"line":220,"column":11},"generated":{"line":1,"column":5978}},{"source":"../../controllers/authController.js","name":"next","original":{"line":220,"column":11},"generated":{"line":1,"column":5985}},{"source":"../../controllers/authController.js","name":"next","original":{"line":220,"column":11},"generated":{"line":1,"column":5994}},{"source":"../../controllers/authController.js","original":{"line":220,"column":16},"generated":{"line":1,"column":5996}},{"source":"../../controllers/authController.js","name":"AppError","original":{"line":220,"column":20},"generated":{"line":1,"column":6000}},{"source":"../../controllers/authController.js","original":{"line":220,"column":29},"generated":{"line":1,"column":6002}},{"source":"../../controllers/authController.js","original":{"line":220,"column":49},"generated":{"line":1,"column":6021}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6028}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6033}},{"source":"../../controllers/authController.js","name":"user","original":{"line":224,"column":8},"generated":{"line":1,"column":6035}},{"source":"../../controllers/authController.js","name":"user","original":{"line":222,"column":2},"generated":{"line":1,"column":6042}},{"source":"../../controllers/authController.js","name":"password","original":{"line":222,"column":7},"generated":{"line":1,"column":6044}},{"source":"../../controllers/authController.js","name":"req","original":{"line":222,"column":18},"generated":{"line":1,"column":6053}},{"source":"../../controllers/authController.js","name":"body","original":{"line":222,"column":22},"generated":{"line":1,"column":6055}},{"source":"../../controllers/authController.js","name":"password","original":{"line":222,"column":27},"generated":{"line":1,"column":6060}},{"source":"../../controllers/authController.js","name":"user","original":{"line":223,"column":2},"generated":{"line":1,"column":6069}},{"source":"../../controllers/authController.js","name":"passwordConfirm","original":{"line":223,"column":7},"generated":{"line":1,"column":6071}},{"source":"../../controllers/authController.js","name":"req","original":{"line":223,"column":25},"generated":{"line":1,"column":6087}},{"source":"../../controllers/authController.js","name":"body","original":{"line":223,"column":29},"generated":{"line":1,"column":6089}},{"source":"../../controllers/authController.js","name":"passwordConfirm","original":{"line":223,"column":34},"generated":{"line":1,"column":6094}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6110}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6112}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6117}},{"source":"../../controllers/authController.js","name":"user","original":{"line":224,"column":8},"generated":{"line":1,"column":6120}},{"source":"../../controllers/authController.js","name":"save","original":{"line":224,"column":13},"generated":{"line":1,"column":6122}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6129}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6134}},{"source":"../../controllers/authController.js","name":"createSendToken","original":{"line":226,"column":2},"generated":{"line":1,"column":6137}},{"source":"../../controllers/authController.js","name":"user","original":{"line":226,"column":18},"generated":{"line":1,"column":6139}},{"source":"../../controllers/authController.js","original":{"line":226,"column":24},"generated":{"line":1,"column":6141}},{"source":"../../controllers/authController.js","name":"req","original":{"line":226,"column":29},"generated":{"line":1,"column":6145}},{"source":"../../controllers/authController.js","name":"res","original":{"line":226,"column":34},"generated":{"line":1,"column":6147}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6150}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6155}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6158}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6162}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6168}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6175}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6177}},{"source":"../../controllers/authController.js","original":{"line":216,"column":36},"generated":{"line":1,"column":6186}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6192}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6199}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6208}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6210}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6212}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6215}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6222}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6224}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6230}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6235}},{"source":"../../controllers/authController.js","original":{"line":216,"column":35},"generated":{"line":1,"column":6247}}],"sources":{"../../controllers/authController.js":"const User = require(\"../models/userModel\");\nconst jwt = require(\"jsonwebtoken\");\nconst { promisify } = require(\"util\");\nconst crypto = require(\"crypto\");\n\nconst AppError = require(\"../utils/appError\");\nconst catchAsync = require(\"../utils/catchAsync\");\nconst Email = require(\"../utils/email\");\n\n// const sendEmail = require(\"../utils/email\");\n\nconst signToken = (id) => {\n  return jwt.sign({ id }, process.env.JWT_SECRET, {\n    expiresIn: process.env.JWT_EXPIRES_IN,\n  });\n};\n\nconst createSendToken = (user, statusCode, req, res) => {\n  const token = signToken(user._id);\n\n  res.cookie(\"jwt\", token, {\n    expires: new Date(\n      Date.now() + process.env.JWT_COOKIE_EXPIRES_IN * 24 * 60 * 60 * 1000\n    ),\n    // secure: process.env.NODE_ENV === \"production\" ? true : false,\n    secure: req.secure || req.headers[\"x-forwarded-proto\"] === \"https\",\n\n    httpOnly: true,\n  });\n\n  user.password = undefined;\n\n  res.status(statusCode).json({\n    status: \"success\",\n    token,\n    data: {\n      user,\n    },\n  });\n};\n\nexports.signup = catchAsync(async (req, res, next) => {\n  const newUser = await User.create(req.body);\n\n  const url = `${req.protocol}://${req.get(\"host\")}/me`;\n\n  await new Email(newUser, url).sendWelcome();\n\n  createSendToken(newUser, 201, req, res);\n});\n\nexports.login = catchAsync(async (req, res, next) => {\n  const { email, password } = req.body;\n\n  if (!email || !password)\n    return next(new AppError(\"Please eneter your email and password\", 400));\n\n  const user = await User.findOne({ email }).select(\"+password\");\n\n  if (!user || !(await user.correctPassword(password, user.password)))\n    return next(new AppError(\"Invalid email or password\", 401));\n\n  createSendToken(user, 200, req, res);\n});\n\nexports.logout = (req, res) => {\n  res.cookie(\"jwt\", \"loggedout\", {\n    expires: new Date(Date.now() + 10 * 1000),\n    httpOnly: true,\n  });\n\n  res.status(200).json({ status: \"success\" });\n};\n\nexports.protect = catchAsync(async (req, res, next) => {\n  let token;\n\n  if (\n    req.headers.authorization &&\n    req.headers.authorization.startsWith(\"Bearer\")\n  ) {\n    token = req.headers.authorization.replace(\"Bearer \", \"\");\n  } else if (req.cookies.jwt) {\n    token = req.cookies.jwt;\n  }\n\n  if (!token)\n    return next(\n      new AppError(\"You are not logged in. Please log on to get access\", 401)\n    );\n\n  const decoded = await promisify(jwt.verify)(token, process.env.JWT_SECRET);\n\n  //   check if user still exists\n  const currentUser = await User.findById(decoded.id);\n\n  if (!currentUser)\n    next(\n      new AppError(\"The user belonging to this token does no longer exist\", 401)\n    );\n\n  //  check if user changed password after the token was issued\n  if (currentUser.changedPasswordAfter(decoded.iat)) {\n    return next(\n      new AppError(\"user recently changed password! Please log in again\", 401)\n    );\n  }\n\n  req.user = currentUser;\n  res.locals.user = currentUser;\n\n  next();\n});\n\nexports.isLoggedIn = async (req, res, next) => {\n  if (req.cookies.jwt) {\n    try {\n      const decoded = await promisify(jwt.verify)(\n        req.cookies.jwt,\n        process.env.JWT_SECRET\n      );\n\n      //   check if user still exists\n      const currentUser = await User.findById(decoded.id);\n\n      //  check if user changed password after the token was issued\n      if (currentUser.changedPasswordAfter(decoded.iat)) {\n        return next();\n      }\n\n      res.locals.user = currentUser;\n\n      return next();\n    } catch (err) {\n      return next();\n    }\n  }\n  next();\n};\n\nexports.restrictTo = (...roles) => {\n  return (req, res, next) => {\n    const user = req.user;\n    if (!roles.includes(user.role)) {\n      return next(\n        new AppError(\"You do not have permission to perform this action\", 403)\n      );\n    }\n\n    next();\n  };\n};\n\nexports.forgotPassword = catchAsync(async (req, res, next) => {\n  const user = await User.findOne({ email: req.body.email });\n\n  if (!user) return next(new AppError(\"User not found\", 404));\n\n  const resetToken = user.createPasswordResetToken();\n\n  await user.save({ validateBeforeSave: false });\n\n  try {\n    // send it to user's email\n    const resetURL = `${req.protocol}://${req.get(\n      \"host\"\n    )}/api/v1/users/resetPassword/${resetToken}`;\n\n    await new Email(user, resetURL).sendPasswordReset();\n\n    res.status(200).json({\n      status: \"success\",\n      message: \"token sent to email\",\n    });\n  } catch (err) {\n    user.passwordResetToken = undefined;\n    user.passwordResetExpires = undefined;\n\n    await user.save({ validateBeforeSave: false });\n\n    return next(\n      new AppError(\n        \"There was an error sending the email. Try again later.\",\n        500\n      )\n    );\n  }\n});\n\nexports.resetPassword = catchAsync(async (req, res, next) => {\n  const hashedToken = crypto\n    .createHash(\"sha256\")\n    .update(req.params.token)\n    .digest(\"hex\");\n\n  const user = await User.findOne({\n    passwordResetToken: hashedToken,\n    passwordResetExpires: { $gt: Date.now() },\n  });\n\n  if (!user) return next(new AppError(\"Token is invalid or has expired\", 400));\n\n  user.password = req.body.password;\n  user.passwordConfirm = req.body.passwordConfirm;\n\n  user.passwordResetExpires = undefined;\n  user.passwordResetToken = undefined;\n\n  await user.save();\n\n  // log the user in, send JWT\n\n  createSendToken(user, 200, req, res);\n});\n\nexports.updatePassword = catchAsync(async (req, res, next) => {\n  const user = await User.findById(req.user.id).select(\"+password\");\n\n  if (!(await user.correctPassword(req.body.passwordCurrent, user.password)))\n    return next(new AppError(\"Invalid password\", 401));\n\n  user.password = req.body.password;\n  user.passwordConfirm = req.body.passwordConfirm;\n  await user.save();\n\n  createSendToken(user, 200, req, res);\n});\n"},"lineCount":null}},"error":null,"hash":"d2b0055a87d0ced3af25e5888b4da75c","cacheData":{"env":{}}}